<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.5">
<title>CloudForms Automation with Ansible Tower</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove comment around @import statement below when using as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.spread{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol,ul.no-bullet,ol.no-bullet{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.no-bullet{list-style:none}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
*:not(pre)>code.nobreak{word-wrap:normal}
*:not(pre)>code.nowrap{white-space:nowrap}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menu{color:rgba(0,0,0,.8)}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all th.tableblock,table.grid-all td.tableblock{border-width:0 1px 1px 0}
table.grid-all tfoot>tr>th.tableblock,table.grid-all tfoot>tr>td.tableblock{border-width:1px 1px 0 0}
table.grid-cols th.tableblock,table.grid-cols td.tableblock{border-width:0 1px 0 0}
table.grid-all *>tr>.tableblock:last-child,table.grid-cols *>tr>.tableblock:last-child{border-right-width:0}
table.grid-rows th.tableblock,table.grid-rows td.tableblock{border-width:0 0 1px 0}
table.grid-all tbody>tr:last-child>th.tableblock,table.grid-all tbody>tr:last-child>td.tableblock,table.grid-all thead:last-child>tr>th.tableblock,table.grid-rows tbody>tr:last-child>th.tableblock,table.grid-rows tbody>tr:last-child>td.tableblock,table.grid-rows thead:last-child>tr>th.tableblock{border-bottom-width:0}
table.grid-rows tfoot>tr>th.tableblock,table.grid-rows tfoot>tr>td.tableblock{border-width:1px 0 0 0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.unstyled,ol.unnumbered,ul.checklist,ul.none{list-style-type:none}
ul.unstyled,ol.unnumbered,ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1em;font-size:.85em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{width:1em;position:relative;top:1px}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:0 .75em;line-height:1}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
</head>
<body class="article">
<div id="header">
</div>
<div id="content">
<div class="sect1">
<h2 id="_cloudforms_automation_with_ansible_tower">CloudForms Automation with Ansible Tower</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_lab_introduction">1. Lab Introduction</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_lab_environment">1.1. Lab Environment</h3>
<div class="paragraph">
<p>Your CloudForms Customization lab environment contains the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Student workstation</p>
</li>
<li>
<p>CloudForms appliance</p>
</li>
<li>
<p>Red Hat Virtualization Manager</p>
</li>
<li>
<p>Red Hat Enterprise Linux + KVM host</p>
</li>
<li>
<p>Red Hat Satellite 6</p>
</li>
<li>
<p>Ansible Tower by Red Hat</p>
</li>
<li>
<p>Storage host</p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
The CloudForms appliance is fully configured with all of the above providers.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_access_lab_workstation">1.2. Access Lab Workstation</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Download the lab private SSH key to your system&#8217;s home directory (key location provided here is just an example):</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">$ curl http://www.opentlc.com/rhte-na/labkey -o ~/.ssh/labkey</code></pre>
</div>
</div>
</li>
<li>
<p>Use SSH to access the lab workstation as <strong>root</strong> using the lab&#8217;s private SSH key:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>For macOS and Linux users, execute the following:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">$ ssh -i ~/.ssh/labkey root@workstation-$GUID.rhpds.opentlc.com</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Replace <code>$GUID</code> with your lab environment GUID provided by the instructor.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>For Windows users, consult <a href="https://www.opentlc.com/ssh.html" target="_blank">this page</a> for documentation on using PuTTY.</p>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
To avoid problems when using SSH to access your lab hosts, always use the FQDN host name and not the IP address.
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_access_red_hat_enterprise_virtualization_console_with_macos">1.3. Access Red Hat Enterprise Virtualization Console with macOS</h3>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
Red Hat Enterprise Virtualization does not support macOS for VM console access. See <a href="https://access.redhat.com/solutions/93613" target="_blank">this page</a> for unsupported steps on obtaining console access for macOS.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_verify_provider_authentication_status">1.4. Verify Provider Authentication Status</h3>
<div class="paragraph">
<p>When the CloudForms appliance and providers are down for any period of time (stopped overnight or initially provisioned in the lab environment) they lose connection to each other. CloudForms does not immediately re-establish connectivity. Every time you start your lab environment you must re-establish the communication between CloudForms and your providers. The appliance does attempt to reconnect at some point, but it may take hours, so it is best to follow the procedure below to get things running sooner.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
If you do not do this every time you start your environment, some of the labs will hang and you will have to start over.
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Log in to your CloudForms appliance at <code><a href="https://cf-$GUID.rhpds.opentlc.com" class="bare">https://cf-$GUID.rhpds.opentlc.com</a></code> as the <code>admin</code> user with the <code>r3dh4t1!</code> password.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Replace <code>$GUID</code> with the GUID provided to you in the email you received from the OPENTLC lab system.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Navigate to <strong>Compute &#8594; Infrastructure &#8594; Providers</strong>.</p>
</li>
<li>
<p>Make sure all of your providers have <span class="image"><img src="images/greencheck.png" alt="greencheck"></span> in the status quadrant as shown here:</p>
<div class="imageblock">
<div class="content">
<img src="images/goodproviders.png" alt="goodproviders">
</div>
</div>
</li>
<li>
<p>If your providers do not have a <span class="image"><img src="images/greencheck.png" alt="greencheck"></span>, you must re-check authentication status:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Click the provider and select <strong>Authentication &#8594; Re-check Authentication Status</strong>:</p>
<div class="imageblock">
<div class="content">
<img src="images/recheck.png" alt="recheck">
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Select <strong>Compute &#8594; Infrastructure &#8594; Providers</strong> repeatedly until the provider&#8217;s status is <span class="image"><img src="images/greencheck.png" alt="greencheck"></span>.</p>
</li>
</ol>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
Be sure to verify provider&#8217;s status following <em>every</em> lab environment startup.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_setup_tower_for_job_template_execution_via_cloudforms">2. Setup Tower for Job Template Execution via CloudForms</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this section you are setting up Ansible Tower as an execution endpoint from CloudForms.</p>
</div>
<div class="sect2">
<h3 id="_configure_machine_credential_in_ansible_tower">2.1. Configure Machine Credential in Ansible Tower</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Log in as the <code>admin</code> user with password <code>r3dh4t1!</code> to Ansible Tower at <code><a href="https://ansible1-$GUID.rhpds.opentlc.com" class="bare">https://ansible1-$GUID.rhpds.opentlc.com</a></code>.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Replace <code>$GUID</code> with the GUID provided to you in the provisioning email you received from the OPENTLC lab system.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Log in to <code>workstation</code> and become <code>root</code> using <code>sudo -i</code>.</p>
</li>
<li>
<p>Run the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">[root@workstation-GUID ~]# cat .ssh/id_rsa</code></pre>
</div>
</div>
</li>
<li>
<p>Copy all of the text including <code><strong>-----BEGIN RSA PRIVATE KEY-----</strong> and <strong>-----END RSA PRIVATE KEY-----</strong></code>.</p>
</li>
<li>
<p>At the top right, click <span class="image"><img src="images/gear.png" alt="gear"></span>.</p>
</li>
<li>
<p>Click <strong>CREDENTIALS</strong>.</p>
</li>
<li>
<p>If you see <strong>Root Password</strong>, delete it by clicking the trash can icon.</p>
</li>
<li>
<p>Click <span class="image"><img src="images/ansible_green_add_icon.png" alt="ansible green add icon"></span> and enter the following:</p>
<div class="ulist">
<ul>
<li>
<p><strong>NAME</strong>: <code>Root Password</code></p>
</li>
<li>
<p><strong>TYPE</strong>: <code>Machine</code></p>
</li>
<li>
<p><strong>USERNAME</strong>: <code>root</code></p>
</li>
<li>
<p><strong>PASSWORD</strong>: <code>r3dh4t1!</code></p>
</li>
<li>
<p><strong>PRIVATE KEY</strong>: Paste the key you copied from <code>workstation</code></p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This information is necessary for Ansible Tower to log in to the VMs you build.
</td>
</tr>
</table>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Click <strong>SAVE</strong></p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_configure_cloudforms_credential_in_ansible_tower">2.2. Configure CloudForms Credential in Ansible Tower</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>At the top right, click the <span class="image"><img src="images/gear.png" alt="gear"></span>.</p>
</li>
<li>
<p>Click <strong>CREDENTIALS</strong>.</p>
</li>
<li>
<p>Click <span class="image"><img src="images/ansible_green_add_icon.png" alt="ansible green add icon"></span> and enter the following:</p>
<div class="ulist">
<ul>
<li>
<p><strong>NAME</strong>: <code>CloudForms Admin</code></p>
</li>
<li>
<p><strong>TYPE</strong>: <code>Red Hat CloudForms</code></p>
</li>
<li>
<p><strong>CLOUDFORMS URL</strong>: <code><a href="https://cf.example.com" class="bare">https://cf.example.com</a></code></p>
</li>
<li>
<p><strong>USERNAME</strong>: <code>admin</code></p>
</li>
<li>
<p><strong>PASSWORD</strong>: <code>r3dh4t1!</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>Click <strong>SAVE</strong></p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This information is necessary for Ansible Tower to get a list of hosts from CloudForms.
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_configure_project_in_ansible_tower">2.3. Configure Project in Ansible Tower</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Navigate to <strong>PROJECTS</strong> at the top of the screen.</p>
</li>
<li>
<p>Click <span class="image"><img src="images/ansible_green_add_icon.png" alt="ansible green add icon"></span> and enter the following:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Name</strong>: <code>cf_customization</code></p>
</li>
<li>
<p><strong>Organization</strong>: <code>Red Hat</code> and click <strong>Select</strong></p>
</li>
<li>
<p><strong>SCM Type</strong>: <code>Git</code></p>
</li>
<li>
<p><strong>SCM URL</strong>: <code><a href="https://github.com/redhat-gpe/cf_customization_public" class="bare">https://github.com/redhat-gpe/cf_customization_public</a></code></p>
</li>
</ul>
</div>
</li>
<li>
<p>Check the <strong>Update on Launch</strong> box.</p>
</li>
<li>
<p>Click <strong>SAVE</strong>.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_create_cloudforms_inventory">2.4. Create CloudForms Inventory</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>At the top of the screen, click <strong>INVENTORIES</strong>.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Click <span class="image"><img src="images/ansible_green_add_icon.png" alt="ansible green add icon"></span>, and enter the following:</p>
<div class="ulist">
<ul>
<li>
<p><strong>NAME</strong>: <code>CloudForms Inventory</code></p>
</li>
<li>
<p><strong>ORGANIZATION</strong>: <code>Red Hat</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>Click <strong>SAVE</strong></p>
</li>
<li>
<p>In the new inventory page, click <span class="image"><img src="images/addgroup.png" alt="addgroup"></span> and complete the following:</p>
<div class="ulist">
<ul>
<li>
<p><strong>NAME</strong>: <code>CloudForms Hosts</code></p>
</li>
<li>
<p><strong>SOURCE</strong>: <code>Red Hat CloudForms</code></p>
</li>
<li>
<p><strong>CLOUD CREDENTIAL</strong>: <code>CloudForms Admin</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>Check the <strong>Update on Launch</strong> box.</p>
</li>
<li>
<p>Click <strong>SAVE</strong>.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This probes CloudForms for a list of hosts and provides an inventory.
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_configure_ansible_job_template">2.5. Configure Ansible Job Template</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>At the top of the screen, click <strong>TEMPLATES</strong>.</p>
</li>
<li>
<p>If you see an existing template called <strong>activate_satellite</strong>, delete it by clicking the trash can icon to its right.</p>
</li>
<li>
<p>Click <span class="image"><img src="images/ansible_green_add_icon.png" alt="ansible green add icon"></span>, then select <strong>Job Template</strong>, and add or select the following parameters:</p>
<div class="ulist">
<ul>
<li>
<p><strong>NAME</strong>: <code>activate_satellite</code>.</p>
</li>
<li>
<p><strong>INVENTORY</strong>: <code>CloudForms Inventory</code></p>
</li>
<li>
<p><strong>PROJECT</strong>: <code>cf_customization</code></p>
</li>
<li>
<p><strong>PLAYBOOK</strong>: <code>satellite_config/satellite_config.yml</code></p>
<div class="ulist">
<ul>
<li>
<p>You may have to scroll down in the list.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>MACHINE CREDENTIAL</strong>: <code>Root Password</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>Under the <strong>LIMIT</strong> text box, check the <strong>Prompt on launch</strong> box.</p>
</li>
<li>
<p>Under the <strong>EXTRA VARIABLES</strong> text box, check the <strong>Prompt on launch</strong> box.</p>
</li>
<li>
<p>Click <strong>SAVE</strong>.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_manage_job_templates_in_cloudforms">2.6. Manage Job Templates in CloudForms</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Log in as the <code>admin</code> user with password <code>r3dh4t1!</code> to CloudForms at <a href="https://cf-$GUID.rhpds.opentlc.com" class="bare">https://cf-$GUID.rhpds.opentlc.com</a>.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Replace <code>$GUID</code> with the GUID provided to you in the provisioning email you received from the OPENTLC lab system.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Navigate to <strong>Automation &#8594; Ansible Tower &#8594; Explorer</strong>.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Select the <strong>Providers</strong> accordion.</p>
</li>
<li>
<p>Go to <strong>All Ansible Tower Providers &#8594; ansible1.example.com Automation Manager</strong>.</p>
</li>
<li>
<p>If you do <em>not</em> see <code>CloudForms Inventory</code> show up below the line that you just clicked, do the following:</p>
<div class="ulist">
<ul>
<li>
<p>Click <strong>Configuration &#8594; Refresh Relationships and Power states</strong> and click <strong>OK</strong>.</p>
</li>
<li>
<p>In the CloudForms UI (not the browser), click <span class="image"><img src="images/reload_refresh_icon.png" alt="reload refresh icon"></span> until <code>CloudForms Inventory</code> appears.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This can take 5 to 10 minutes.
</td>
</tr>
</table>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Click the <strong>Job Templates</strong> accordion.</p>
</li>
<li>
<p>Navigate to <strong>All Ansible Tower Job Templates &#8594; ansible1.example.com Automation Manager</strong>.</p>
</li>
<li>
<p>If you do <em>not</em> see <code>activate_satellite</code> show up below the line you just clicked, do the following:</p>
<div class="ulist">
<ul>
<li>
<p>Click <strong>Configuration &#8594; Refresh Relationships and Power states</strong> and click <strong>OK</strong>.</p>
</li>
<li>
<p>In the CloudForms UI (not the browser), click <span class="image"><img src="images/reload_refresh_icon.png" alt="reload refresh icon"></span> until <code>motd</code> appears.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This can take 5 to 10 minutes.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
If this takes longer than 10 minutes, there is a problem with your environment. Make sure the Automate role is enabled and you do not have any hung providers. Also make sure that <code>ansible1</code> is up and running.
</td>
</tr>
</table>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Click the <code>activate_satellite</code> job template.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_use_ansible_tower_and_satellite_6_integration_during_provisioning">3. Use Ansible Tower and Satellite 6 Integration During Provisioning</h2>
<div class="sectionbody">
<div class="paragraph">
<p>It is a relatively common requirement to register newly provisioned Linux VMs directly with Red Hat Satellite 6 (or Foreman) as part of the provisioning process. This ensures that the resultant VM is patched and up-to-date and configured by Puppet according to a server role.</p>
</div>
<div class="paragraph">
<p>Registering a new system with Satellite 6 currently requires two operations. You must create a Satellite <em>host</em> entry, which registers the server as a configuration management client, manageable by Puppet. You also must use <code>subscription-manager</code> to activate the server as a <em>content host</em>, which associates one or more Red Hat subscriptions with the server, and makes software package repository content available.</p>
</div>
<div class="paragraph">
<p>In this exercise, you look at the changes to your provisioning workflow that are needed to make this happen.</p>
</div>
<div class="sect2">
<h3 id="_explore_triggering_client_operations">3.1. Explore Triggering Client Operations</h3>
<div class="paragraph">
<p>In this section, you clone a VM from a fully installed <em>fat</em> template. Fat templates are those for which no kickstarting is performed. Cloning from template (infrastructure providers) or image (cloud providers) presents you with the challenge of how to initiate several commands on the new VM, including <code>subscription-manager register</code>, using dynamic arguments such as <code>--activationkey</code> or <code>--org</code>.</p>
</div>
<div class="paragraph">
<p>There are several ways of remotely running commands in a newly created VM:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>VMware VIX SDK Library, to connect to VMware Tools running in a guest (VMware only)</p>
</li>
<li>
<p><code>cloud-init</code> (Red Hat Enterprise Virtualization, OpenStack, and Amazon providers)</p>
</li>
<li>
<p>SSH, including Ansible (all providers)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In this lab, you trigger the subscription-manager registration of the newly provisioned system using an Ansible playbook via Ansible Tower.</p>
</div>
<div class="paragraph">
<p>A host entry in Satellite 6 requires certain parameters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Host name</p>
</li>
<li>
<p>Host&#8217;s MAC address</p>
</li>
<li>
<p>Location</p>
</li>
<li>
<p>Organization</p>
</li>
<li>
<p>Puppet environment</p>
</li>
<li>
<p>Architecture</p>
</li>
<li>
<p>Operating system</p>
</li>
<li>
<p>Media</p>
</li>
<li>
<p>Partition table</p>
</li>
<li>
<p>Domain</p>
</li>
<li>
<p>Root password</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can define a host group in Satellite, containing defaults for several of these parameters. When you create the host entry, you can specify a host group as a configuration template.</p>
</div>
</div>
<div class="sect2">
<h3 id="_confirm_satellite_environment_configuration">3.2. Confirm Satellite Environment Configuration</h3>
<div class="paragraph">
<p>In this section, you confirm the Satellite environment configuration. To keep the example simple, you allow for provisioning Red Hat Enterprise Linux 6 and 7 servers (both 64-bit), but you create a single generic host group and activation key for each operating system version.</p>
</div>
<div class="sect3">
<h4 id="_confirm_activation_keys_in_satellite_6">3.2.1. Confirm Activation Keys in Satellite 6</h4>
<div class="paragraph">
<p>When a newly provisioned system registers with Satellite as a content host, it can include an activation key name as an argument to <code>subscription-manager</code>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Log in to your Satellite 6 server at <code><a href="https://sat-$GUID.rhpds.opentlc.com" class="bare">https://sat-$GUID.rhpds.opentlc.com</a></code> with user <code>admin</code> and password <code>r3dh4t1!</code>.</p>
</li>
<li>
<p>In <strong>Content &#8594; Activation keys</strong>, confirm that there is an existing activation key called <code>rhel7</code>:</p>
<div class="imageblock">
<div class="content">
<img src="images/satscreenshot6.png" alt="satscreenshot6">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>These activation keys define defaults for:</p>
<div class="ulist">
<ul>
<li>
<p>Content view and life-cycle environment ("Production")</p>
</li>
<li>
<p>Red Hat subscriptions</p>
</li>
<li>
<p>Repository content sets</p>
</li>
</ul>
</div>
</li>
<li>
<p>Ansible subscribes the VM to Satellite using this <code>rhel7</code> key.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_confirm_host_groups_in_satellite_6">3.2.2. Confirm Host Groups in Satellite 6</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In your Satellite 6 server, go to <strong>Configure &#8594; Host Groups</strong> and confirm that there is a host group named <code>Generic_RHEL7_Servers</code>:</p>
<div class="imageblock">
<div class="content">
<img src="images/satscreenshot1.png" alt="satscreenshot1">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Host groups define defaults for:</p>
<div class="ulist">
<ul>
<li>
<p>Puppet environment</p>
</li>
<li>
<p>Architecture</p>
</li>
<li>
<p>Operating system</p>
</li>
<li>
<p>Media</p>
</li>
<li>
<p>Partition table</p>
</li>
<li>
<p>Domain</p>
</li>
<li>
<p>Root password</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_confirm_satellite_services">3.3. Confirm Satellite Services</h3>
<div class="paragraph">
<p>Sometimes the Satellite server does not start up correctly in the lab environment.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>From <code>workstation</code>, use SSH as <code>root</code> to access <code>sat.example.com</code>.</p>
</li>
<li>
<p>Run the following command to check the services status:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">[root@sat ~]# katello-service status</code></pre>
</div>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Look for failures on the last line of the output:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">Some services failed to status: mongod,pulp_celerybeat</code></pre>
</div>
</div>
</li>
<li>
<p>If you see this failure, do this:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">[root@sat ~]# katello-service restart</code></pre>
</div>
</div>
</li>
<li>
<p>If you had to restart the services, run the status again:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">[root@sat ~]# katello-service status</code></pre>
</div>
</div>
</li>
<li>
<p>Look for success on the last line of the output:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">Success!</code></pre>
</div>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_modify_cloudforms_provisioning_workflow">3.4. Modify CloudForms Provisioning Workflow</h3>
<div class="paragraph">
<p>From the CloudForms UI, make two additions to the <code>VMProvision_VM</code> state machine. You add a <code>RegisterSatellite</code> state to register the new VM with Satellite 6 as a host. You create code that integrates with the Satellite API to add the VM to a host group.</p>
</div>
<div class="paragraph">
<p>You also add an <code>ActivateSatellite</code> state to launch an Ansible playbook via Ansible Tower and an SSH that initiates the <code>subscription-manager</code> activation of the new system as a content host.</p>
</div>
<div class="paragraph">
<p>Both of these stages must be added at some point after the VM is provisioned.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Log in as the <code>admin</code> user with password <code>r3dh4t1!</code> to CloudForms at <a href="https://cf-$GUID.rhpds.opentlc.com" class="bare">https://cf-$GUID.rhpds.opentlc.com</a>.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Replace <code>$GUID</code> with the GUID provided to you in the provisioning email you received from the OPENTLC lab system.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Navigate to <strong>Automation &#8594; Automate &#8594; Explorer</strong></p>
</li>
<li>
<p>Ensure only <code>ManageIQ</code>, <code>RedHat</code>, and <code>SatDomain</code> Automate domains are enabled, and that <code>SatDomain</code> is at the top of the tree.  Any other custom domains should be disabled.</p>
</li>
<li>
<p>Copy the <code>/ManageIQ/Infrastructure/VM/Provisioning/StateMachines/VMProvision_VM/Provision VM from Template (template)</code> instance to <code>SatDomain</code>.</p>
</li>
<li>
<p>Edit the class schema at <code>/SatDomain/Infrastructure/VM/Provisioning/StateMachines/VMProvision_VM</code> to add these states:</p>
<div class="ulist">
<ul>
<li>
<p><code>RegisterSatellite</code></p>
</li>
<li>
<p><code>ActivateSatellite</code></p>
<div class="imageblock">
<div class="content">
<img src="images/satelliteedits.png" alt="satelliteedits">
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Modify the sequence so that it looks like this:</p>
<div class="imageblock">
<div class="content">
<img src="images/schema_order.png" alt="schema order">
</div>
</div>
</li>
<li>
<p>Edit the <code>/SatDomain/Infrastructure/VM/Provisioning/StateMachines/VMProvision_VM/Provision VM from Template (template)</code> instance:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Populate <code>RegisterSatellite</code> with <code>/Integration/Satellite/Methods/RegisterSatellite</code>.</p>
</li>
<li>
<p>Populate <code>ActivateSatellite</code> with <code>/AutomationManagement/AnsibleTower/Operations/JobTemplate/activate_satellite</code>.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This uses the built-in functionality in Automate to launch an Ansible playbook via Ansible Tower for the VM being built. The <code>activate_satellite</code> string corresponds to a job template predefined in your Ansible Tower. You could put any job template defined in Ansible Tower that you wish in here assuming it works with the host being built. You can see a list of job templates that CloudForms is aware of by logging in to CloudForms and navigating to <strong>Configuration &#8594; Configuration Management &#8594; Ansible Tower Job Templates &#8594; All Ansible Tower Job Templates &#8594; ansible1.example.com Configuration Manager</strong>:
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="images/satscreenshot2.png" alt="satscreenshot2">
</div>
</div>
</li>
<li>
<p>Save your changes.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Navigate to <code>/SatDomain/Integration/Satellite/Methods/RegisterSatellite</code> and examine the contents.</p>
</li>
<li>
<p>Also examine the contents of the <code>register_satellite</code> method in the same namespace/class.  Below outlines the code:</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Satellite Registration using the API can be done via Ansible, but you use Ruby for this example.
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>Assuming the VM being built is Linux (which it is in this case), the code selects a host group by testing the VM operating system object&#8217;s <code>.product_name</code> attribute:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">...
prov = $evm.root['miq_provision']
template = prov.source
vm = prov.destination

if template.platform == "linux"
  #
  # Pick a host group based on the operating system being provisioned
  #
  if vm.operating_system.product_name == 'Red Hat Enterprise Linux 6 (64-bit)' || vm.operating_system.product_name == 'rhel_6x64'
    hostgroup = 'Generic_RHEL6_Servers'
  elsif vm.operating_system.product_name == 'Red Hat Enterprise Linux 7 (64-bit)' || vm.operating_system.product_name == 'rhel_7x64'
    hostgroup = 'Generic_RHEL7_Servers'
  else
    raise "Unrecognised Operating System Name"
  end
...</code></pre>
</div>
</div>
</li>
<li>
<p>The code creates the new host entry using the Satellite API, which requires the internal Satellite ID for each parameter rather than a name. It defines a generic <code>query_id</code> method, and calls it three times to retrieve the IDs for the location, organization, and host group:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">def query_id (uri, field, content)

  url = URI.escape("#{@uri_base}/#{uri}?search=#{field}=\"#{content}\"")
  request = RestClient::Request.new(
    method: :get,
    url: url,
    headers: @headers,
    verify_ssl: OpenSSL::SSL::VERIFY_NONE
  )

  id = nil
  rest_result = request.execute
  json_parse = JSON.parse(rest_result)

  subtotal = json_parse['subtotal'].to_i
  if subtotal == 1
    id = json_parse['results'][0]['id'].to_s
  elsif subtotal.zero?
    $evm.log(:error, "Query to #{url} failed, no result")
    id = -1
  elsif subtotal &gt; 1
    $evm.log(:error, "Query to #{url} returned multiple results")
    id = -1
  else
    $evm.log(:error, "Query to #{url} failed, unknown condition")
    id = -1
  end
  id
end

...
$evm.log(:info, "Getting hostgroup id for '#{hostgroup}' from Satellite")
hostgroup_id = query_id("hostgroups", "name", hostgroup)
raise "Cannot determine hostgroup id for '#{hostgroup}'" if hostgroup_id == -1
$evm.log(:info, "hostgroup_id: #{hostgroup_id}")</code></pre>
</div>
</div>
</li>
<li>
<p>Finally, the code creates the host record. It specifies the <code>:build</code> parameter as <code>false</code>, because you do not want Satellite to provision the VM:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">#
# Create the host record
#
hostinfo = {
    :name             =&gt; vm.name,
    :mac              =&gt; vm.mac_addresses[0],
    :hostgroup_id     =&gt; hostgroup_id,
    :location_id      =&gt; location_id,
    :organization_id  =&gt; organization_id,
    :build            =&gt; 'false'
    }
$evm.log(:info, "Creating host record in Satellite")

uri = "#{@uri_base}/hosts"
request = RestClient::Request.new(
    method: :post,
    url: uri,
    headers: @headers,
    verify_ssl: OpenSSL::SSL::VERIFY_NONE,
    payload: { host: hostinfo }.to_json
  )
rest_result = request.execute</code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_test_integration_and_monitor_progress">3.5. Test Integration and Monitor Progress</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Navigate to <strong>Compute &#8594; Infrastructure &#8594; Virtual Machines</strong>.</p>
</li>
<li>
<p>Navigate to the <strong>VMs</strong> accordion.</p>
</li>
<li>
<p>Click <strong>Lifecycle &#8594; Provision VMs</strong>.</p>
</li>
<li>
<p>Select the <code>rhel7-guest-image</code> template and click <strong>Continue</strong>.</p>
</li>
<li>
<p>Fill in your <strong>E-Mail</strong></p>
</li>
<li>
<p>Fill in your <strong>First Name</strong></p>
</li>
<li>
<p>Fill in your <strong>Last Name</strong></p>
</li>
<li>
<p>Select the <strong>Catalog</strong> tab and enter <code>satlab.example.com</code> for <strong>VM Name</strong>.</p>
</li>
<li>
<p>Select the <strong>Environment</strong> tab and check the <strong>Choose Automatically</strong> box.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Please do not change memory, CPU, or disk settings, as we are using a nested virtualization environment with limited resources.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Select the <strong>Customize</strong> tab, and enter or select the following:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Root Password</strong>: <code>r3dh4t1!</code></p>
</li>
<li>
<p><strong>Address Mode</strong>: <code>Static</code></p>
</li>
<li>
<p><strong>Host Name</strong>: <code>satlab.example.com</code></p>
</li>
<li>
<p><strong>IP Address</strong>: <code>192.168.1.150</code></p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Because of lack of DNS in the environment, the above IP address and network settings must be used.
</td>
</tr>
</table>
</div>
</li>
<li>
<p><strong>Subnet Mask</strong>: <code>16</code></p>
</li>
<li>
<p><strong>Gateway</strong>: <code>192.168.0.2</code></p>
</li>
<li>
<p><strong>DNS Server list</strong>: <code>192.168.0.1</code></p>
</li>
<li>
<p><strong>DNS Suffix list</strong>: <code>example.com</code></p>
</li>
<li>
<p><strong>Script Name</strong>: <code>Red Hat Cloud Image Template</code></p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The out-of-the-box <code>oVirt cloud-init</code> customization template that comes with CloudForms 4.5 GA is broken. The Red Hat Cloud Image Template is a custom one that fixes the broken GA cloud-init script.
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
Make sure you use the requested FQDN in the VM host name so that the Puppet master can auto-sign the certificate later.
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="images/satscreenshot8.png" alt="satscreenshot8">
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Click <strong>Submit</strong>.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
You must monitor everything in this section at the same time.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Monitor <code>automation.log</code> on the CloudForms appliance and check for output from <code>register_satellite</code> in <code>automation.log</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">&lt;AEMethod register_satellite&gt; Getting hostgroup id for 'Generic_RHEL7_Servers' from Satellite
&lt;AEMethod register_satellite&gt; hostgroup_id: ..
&lt;AEMethod register_satellite&gt; Getting location id for 'Default Location' from Satellite
&lt;AEMethod register_satellite&gt; location_id: ..
&lt;AEMethod register_satellite&gt; Getting organization id for 'Default Organization' from Satellite
&lt;AEMethod register_satellite&gt; organization_id: ..
&lt;AEMethod register_satellite&gt; Creating host record in Satellite with the following details: \
        {:name=&gt;"satlab.example.com", :mac=&gt;"00:...", :hostgroup_id=&gt;"..", \
         :location_id=&gt;"..", :organization_id=&gt;"..", :build=&gt;"false"}
&lt;AEMethod register_satellite&gt; return code =&gt; &lt;200&gt;</code></pre>
</div>
</div>
</li>
<li>
<p>Log in to <code><a href="https://ansible1-$GUID.rhpds.opentlc.com" class="bare">https://ansible1-$GUID.rhpds.opentlc.com</a></code> and click <strong>JOBS</strong> at the top of the screen.</p>
</li>
<li>
<p>Click the <code>activate_satellite</code> job.</p>
</li>
<li>
<p>Look for output similar to this:</p>
<div class="imageblock">
<div class="content">
<img src="images/ansiblelab2.png" alt="ansiblelab2">
</div>
</div>
</li>
<li>
<p>Examine the <strong>Apply Puppet</strong> step of the Ansible job and expect to see an ignored error:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">TASK [Apply Puppet] ************************************************************20:53:00
41
fatal: [satlab.example.com]: FAILED! =&gt; {"changed": true, "cmd": ["/usr/bin/puppet", "agent", "-t", "--server", "sat.example.com"], "delta": "0:00:08.493309", "end": "2017-06-16 20:53:08.719643", "failed": true, "rc": 2, "start": "2017-06-16 20:53:00.226334", "stderr": "", "stderr_lines": [], "stdout": "\Info: Retrieving pluginfacts\\n\Info: Retrieving plugin\\n\Info: Caching catalog for satlab.example.com\\n\Info: Applying configuration version '1497660789'\\n\[mNotice: /Stage[main]/Motd/File[/etc/motd]/content: \n--- /etc/motd\t2013-06-07 10:31:32.000000000 -0400\n+++ /tmp/puppet-file20170616-10957-1bdvmaa\t2017-06-16 20:53:07.850364367 -0400\n@@ -0,0 +1 @@\n+This is the default message \n\\n\Info: Computing checksum on file /etc/motd\\n\Info: /Stage[main]/Motd/File[/etc/motd]: Filebucketed /etc/motd to puppet with sum d41d8cd98f00b204e9800998ecf8427e\\n\[mNotice: /Stag…</code></pre>
</div>
</div>
</li>
<li>
<p>Log in to <code><a href="https://sat-$GUID.rhpds.opentlc.com" class="bare">https://sat-$GUID.rhpds.opentlc.com</a></code> and monitor <strong>Hosts &#8594; All Hosts</strong>.</p>
<div class="ulist">
<ul>
<li>
<p>In Satellite <strong>Hosts &#8594; All Hosts</strong>, you eventually see a new host entry:</p>
<div class="imageblock">
<div class="content">
<img src="images/satscreenshot10.png" alt="satscreenshot10">
</div>
</div>
</li>
<li>
<p>In Satellite <strong>Hosts &#8594; Content Hosts</strong>, you eventually see a new content host entry, showing that all packages need to be updated (Ansible is doing this for you now):</p>
<div class="imageblock">
<div class="content">
<img src="images/satscreenshot11.png" alt="satscreenshot11">
</div>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_examine_playbook_and_job_completion">3.6. Examine Playbook and Job Completion</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The Ansible Playbook you used to activate Satellite is pulled dynamically from <a href="https://github.com/redhat-gpe/cf_customization_public/blob/master/satellite_config/satellite_config.yml">"satellite_config.yml^"</a>. Take a look at it while you wait for the Ansible job to complete the yum update.</p>
</li>
<li>
<p>When the Ansible job is complete, the content host record shows that all of the packages are updated (this can take a while):</p>
<div class="imageblock">
<div class="content">
<img src="images/content_done.png" alt="content done">
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_stretch_goal_create_custom_job_template_utilizing_ansible_extra_variables_in_cloudforms">4. Stretch Goal: Create Custom Job Template utilizing Ansible Extra Variables in CloudForms</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This is only to be completed if time allows.  Some steps are left out on purpose to challenge your current knowledge and understanding of the CloudForms/Tower integration.  Have fun with it!
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_create_a_project_playbook_in_tower">4.1. Create a Project/Playbook in Tower</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create an empty repository in your personal GitHub account</p>
</li>
<li>
<p>Decide what you would like to Automate</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Common examples are:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Install an RPM package</p>
</li>
<li>
<p>Create a file with content</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Create the Ansible playbook.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Be sure to require an extra variable in this playbook</p>
</li>
</ol>
</div>
</li>
<li>
<p>Create the Project in Ansible Tower and tie it to your GitHub repository which contains the Ansible Playbook.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_create_job_template_in_tower">4.2. Create Job Template in Tower</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a job template in Ansible Tower with the following requirements</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Below the <strong>LIMIT</strong> text box, check the <strong>Prompt on launch</strong> box.</p>
</li>
<li>
<p>This should be tied to the project you just created in the step above.</p>
</li>
<li>
<p>In the <strong>EXTRA VARIABLES</strong> text box enter any of the required variables like so:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-text" data-lang="text">---
my_extra_variable:</code></pre>
</div>
</div>
</li>
<li>
<p>Below the <strong>EXTRA VARIABLES</strong> text box, check the <strong>Prompt on launch</strong> box.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_refresh_provider_in_cloudforms">4.3. Refresh Provider in CloudForms</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In CloudForms, refresh the Ansible Tower provider so that you can see the new job template.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_insert_job_template_into_provisioning_workflow">4.4. Insert Job Template into Provisioning Workflow</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Using your previous expertise with modifying the VM provisioning workflow, insert your new Playbook into the provisioning workflow.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_provision_the_vm">4.5. Provision the VM</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Navigate to <strong>Compute &#8594; Infrastructure &#8594; Virtual Machines</strong>.</p>
</li>
<li>
<p>Navigate to the <strong>VMs</strong> accordion.</p>
</li>
<li>
<p>Click <strong>Lifecycle &#8594; Provision VMs</strong>.</p>
</li>
<li>
<p>Select the <code>rhel7-guest-image</code> template and click <strong>Continue</strong>.</p>
</li>
<li>
<p>Fill in your <strong>E-Mail</strong></p>
</li>
<li>
<p>Fill in your <strong>First Name</strong></p>
</li>
<li>
<p>Fill in your <strong>Last Name</strong></p>
</li>
<li>
<p>Select the <strong>Catalog</strong> tab and enter <code>stretch.example.com</code> for <strong>VM Name</strong>.</p>
</li>
<li>
<p>Select the <strong>Environment</strong> tab and check the <strong>Choose Automatically</strong> box.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Please do not change memory, CPU, or disk settings, as we are using a nested virtualization environment with limited resources.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Select the <strong>Customize</strong> tab, and enter or select the following:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Root Password</strong>: <code>r3dh4t1!</code></p>
</li>
<li>
<p><strong>Address Mode</strong>: <code>Static</code></p>
</li>
<li>
<p><strong>Host Name</strong>: <code>stretch.example.com</code></p>
</li>
<li>
<p><strong>IP Address</strong>: <code>192.168.1.151</code></p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Because of lack of DNS in the environment, the above IP address and network settings must be used.
</td>
</tr>
</table>
</div>
</li>
<li>
<p><strong>Subnet Mask</strong>: <code>16</code></p>
</li>
<li>
<p><strong>Gateway</strong>: <code>192.168.0.2</code></p>
</li>
<li>
<p><strong>DNS Server list</strong>: <code>192.168.0.1</code></p>
</li>
<li>
<p><strong>DNS Suffix list</strong>: <code>example.com</code></p>
</li>
<li>
<p><strong>Script Name</strong>: <code>Red Hat Cloud Image Template</code></p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The out-of-the-box <code>oVirt cloud-init</code> customization template that comes with CloudForms 4.5 GA is broken. The Red Hat Cloud Image Template is a custom one that fixes the broken GA cloud-init script.
</td>
</tr>
</table>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_examine_outcome">4.6. Examine Outcome</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Wait for the VM provision to complete.</p>
</li>
<li>
<p>When the VM provision is complete, use SSH to remotely connect to your VM and verify that your playbook executed correctly</p>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2017-10-07 20:17:48 EDT
</div>
</div>
</body>
</html>